Входные параметры:
```
    - z             : [B, N]            (complex)
    - z_j           : [B, M, N]         (complex)
    - vec_d         : [B, N]            (same dtype as z)
    - vec_d_j       : [B, M, N]         (same dtype as z)
    - T_hat_j       : [B, M, S]         (complex, contributes to final T)
    - alpha_j       : [B, M]            (real)
    - sigma_par     : [B, M]            (real; parallel scale)
    - sigma_perp    : [B, M]            (real; perpendicular scale)
	...
	(дополнительные параметры — опционально)
```

Условия валидности:
- Численная эквивалентность результатов (в пределах допусков) с T_classic_window() или T_classic_full() на идентичных входных данных.
- Контролируемый уровень предельной ошибки. Базовый допуск: 1.0e-4.

Требования:
- Линейность по памяти по N, M.
- Линейность по вычислительной сложности по N, M.
- Поддержка высоких размерностей N (> 128) и M (> 4096) в пределах минимальной утилизации ресурсов (для этого нужна линейность по памяти и по вычислительной сложности по N и M).

Ограничения:
- Не использовать прямую суммацию по решётке.
- Не использовать cosh().
- Отсутствие кеша.
- Отсутствие материализации тензоров (везде, где возможно).

Разрешено:
- Прибегать к любым методам оптимизации.
- Нарушать гладкость градиента или полностью его разрывать.
- Переформулировать теорию CPSF при условии сохранения численной эквивалентности результатов с классическими методами расчёта (численная эквивалентность CPSF).

Подсказки:
Theta-функции (1D), omega-функции, Гаусс-Эрмит, Эрмит-Кленшоу, разложение Чебышёва, Пуассоновская суммация, разложение в ряды.