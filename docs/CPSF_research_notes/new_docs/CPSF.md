## Core Terms

This section establishes the fundamental mathematical objects and notation used throughout CPSF. All definitions employ the standard Hermitian inner product $\langle u, v \rangle := \sum_{j=1}^N \overline{u_j} v_j$ in $\mathbb{C}^N$.

---

### Complex Torus

**$\mathbb{T}_\mathbb{C}^N := \mathbb{C}^N / \Lambda$** — *compact complex torus*, formed by quotienting complex space $\mathbb{C}^N$ by a discrete full-rank lattice $\Lambda \subset \mathbb{C}^N$, typically $\Lambda = \mathbb{Z}^N + i \mathbb{Z}^N$. This generalizes the real torus and supports a global Fourier basis indexed by the dual lattice $\Lambda^* \subset \mathbb{C}^N$.

> **Lattice structure clarification**:
>
> A full-rank lattice $\Lambda \subset \mathbb{C}^N$ is a discrete additive subgroup generated by $2N$ real linearly independent vectors. That is, $\Lambda$ is a free $\mathbb{Z}$-module of rank $2N$ spanning $\mathbb{C}^N$ over $\mathbb{R}$.
>
> The torus $\mathbb{T}_\mathbb{C}^N = \mathbb{C}^N / \Lambda$ inherits its topology and metric from the Euclidean (Hermitian) norm on $\mathbb{C}^N$, and defines periodicity by identification $z \sim z + \lambda$ for all $\lambda \in \Lambda$.
>
> The dual lattice $\Lambda^* \subset \mathbb{C}^N$ is defined with respect to the Hermitian pairing $\langle m, z \rangle := \sum_{j=1}^N \overline{m_j} z_j$, and consists of all $m \in \mathbb{C}^N$ such that $\langle m, \lambda \rangle \in \mathbb{Z}$ for all $\lambda \in \Lambda$.
>
> This Hermitian pairing ensures compatibility with the geometry of $\mathbb{C}^N$, including the unitary structures defined elsewhere in CPSF.
>
> As the dual of a discrete lattice, $\Lambda^*$ is itself discrete and additive.

---

### Toroidal Spectral Coordinates

**$\mathbb{T}_\mathbb{C}^N := \mathbb{C}^N / \Lambda$** — *N-dimensional complex torus*, serving as the toroidal spatial domain for harmonic projection; a compact, orientable, boundaryless complex manifold.

All coordinates $z \in \mathbb{T}_\mathbb{C}^N$ are complex positions modulo the lattice $\Lambda \subset \mathbb{C}^N$. Arithmetic is periodic over $\mathbb{C}^N$ modulo $\Lambda$, enabling toroidal continuity and Fourier projection.

**Spectral Basis** — Global toroidal harmonics $\phi_m(z) := e^{2\pi i \langle m, z \rangle}$, where $m \in \Lambda^*$ and $\langle m, z \rangle := \sum_{j=1}^N \overline{m_j} z_j$, form a complete orthonormal basis in $L^2(\mathbb{T}_\mathbb{C}^N)$. They satisfy $\phi_m(z + \lambda) = \phi_m(z) \cdot e^{2\pi i \langle m, \lambda \rangle}$ and are covariant under toroidal shifts.

The phase factor $e^{2\pi i \langle m, \lambda \rangle}$ encodes the shift symmetry of the basis under toroidal translations, ensuring covariance of the harmonic structure with respect to spatial shifts in $z$.

The index $m \in \Lambda^*$ is a discrete spectral vector defining the frequency mode of the harmonic. Each component determines the dual frequency along a corresponding complex lattice direction.

---

### Lifted Coordinates

**$\tilde{z}, \tilde{z}_j \in \mathbb{C}^N$** — *lifted coordinates* corresponding to toroidal positions $z, z_j \in \mathbb{T}_\mathbb{C}^N$.

These are representatives in $\mathbb{C}^N$ satisfying:
$\tilde{z} \equiv z \mod \Lambda, \quad \tilde{z}_j \equiv z_j \mod \Lambda$

They allow computations in Euclidean space before restoring toroidal periodicity.

---

### Projection Coordinates

**$\ell := (z, \vec{d}) \in \mathbb{T}_\mathbb{C}^N \times \mathbb{C}^N$** — *projection coordinate (ray)*.

Defines the geometric configuration of directional observation or interaction within CPSF.

* **Origin**: $z \in \mathbb{T}_\mathbb{C}^N$ — base point on the complex torus;
* **Direction**: $\vec{d} \in \mathbb{C}^N, \|\vec{d}\| = 1$ — unit complex direction vector;
* The pair $(z, \vec{d})$ defines a unique complex ray in the extended projection space:

$$
z(t) = z + t \cdot \vec{d} \mod \Lambda
$$

All directions $\vec{d} \in \mathbb{C}^N$ are constrained to lie on the unit sphere in $\mathbb{C}^N$:  
$$
\mathbb{S}^{2N-1}_\text{unit} := \left\{ \vec{d} \in \mathbb{C}^N : \sum_{j=1}^N |d_j|^2 = 1 \right\}
$$
This is the $(2N - 1)$-dimensional unit sphere in $\mathbb{R}^{2N} \cong \mathbb{C}^N$, equipped with the unitarily invariant surface measure. This constraint is enforced throughout all geometric and analytic constructions in CPSF.

---

### Projection Space

**$\mathbb{T}_\mathbb{C}^N \times \mathbb{C}^N$** — *projection space*, the extended coordinate domain of the CPSF field.

In the geometric layer of CPSF, this space represents the set of all possible ray configurations. As the direction vector $\vec{d}$ is always unit-normed, the true domain of projection is the product manifold $\mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}$, not the full space $\mathbb{C}^N$.

Thus, the projection space unifies spatial and directional components as a domain for functions $T(z, \vec{d}) \in \mathbb{C}^S$.

> **Note**: This analytic treatment does not override the geometric interpretation of $\vec{d}$ as a fixed direction per ray in core CPSF definitions. Rather, it generalizes the domain to support functional and variational constructions.

---

### Attenuation Parameters

**$\sigma^{\parallel} \in \mathbb{R}_{>0}$** — *longitudinal attenuation scalar*.

A single positive real value controlling the projection envelope's scale **along the ray direction** $\vec{d}$; determines the effective extent of contribution along the ray.

**$\sigma^{\perp} \in \mathbb{R}_{>0}$** — *transverse attenuation scalar*.

A single positive real value controlling isotropic decay **in all directions orthogonal to** $\vec{d}$ within the ambient space $\mathbb{C}^N$.

---

### Orthonormal Frame

**$R(\vec{d}) \in \mathrm{U}(N)$** — *unitary matrix* associated with the direction vector $\vec{d} \in \mathbb{C}^N, \| \vec{d} \| = 1$.

It satisfies:

* $R e_1 = \vec{d}$ — the first column aligns with the projection direction;
* $R^\dagger R = I_N$ — the matrix is unitary;
* The remaining $N - 1$ columns span the orthogonal complement of $\vec{d}$ **with respect to the standard Hermitian inner product**.

> **All orthogonality statements are defined with respect to the standard Hermitian inner product in $\mathbb{C}^N$:**
>
> $\langle u, v \rangle := \sum_{j=1}^N \overline{u_j} v_j$
>
> This form of orthogonality is preserved by unitary transformations and defines the geometry of $\mathrm{U}(N)$.

The construction of $R(\vec{d})$ is defined separately (see *CPSF: Orthonormal Frame Construction*).

---

### Extended Orthonormal Frame

**$\mathcal{R}(\vec{d}) \in \mathrm{U}(2N)$** — *block-diagonal unitary matrix* defined as:

$$
\mathcal{R}(\vec{d}) := \mathrm{diag}(R(\vec{d}), R(\vec{d}))
$$

> **Rationale for block-diagonal structure**:
>
> The space $\mathbb{C}^{2N}$ arises as the product of toroidal positions and complex directions, reflecting the structure $\mathbb{T}_\mathbb{C}^N \times \mathbb{C}^N \cong \mathbb{C}^{2N}$. The block-diagonal form of the extended orthonormal frame $\mathcal{R}(\vec{d}) := \mathrm{diag}(R(\vec{d}), R(\vec{d})) \in \mathrm{U}(2N)$ mirrors this decomposition, applying the same unitary transformation $R(\vec{d})$ to both the position and direction components. This ensures that anisotropic scaling and directional alignment with respect to $\vec{d}$ are preserved uniformly when constructing the covariance matrix $\Sigma_j$.


It defines a unitary frame in $\mathbb{C}^{2N}$, aligned with the projection direction $\vec{d} \in \mathbb{C}^N$. Used in the construction of directionally aligned anisotropic structures, such as the geometric covariance matrix $\Sigma_j$.

---

### Canonical Embedding

**$\iota : \mathbb{C}^N \times \mathbb{C}^N \to \mathbb{C}^{2N}$** — *canonical embedding map*, defined by:
$\iota(u, v) := \begin{bmatrix} u \\ v \end{bmatrix}$

Used to embed relative spatial and directional offsets into the extended projection space $\mathbb{C}^{2N} \cong \mathbb{C}_\text{pos}^N \oplus \mathbb{C}_\text{dir}^N$.

---

### Geometric Covariance Matrix

**$\Sigma_j \in \mathbb{C}^{2N \times 2N}$** — *anisotropic localization matrix* associated with the projection coordinate $\ell_j = (z_j, \vec{d}_j)$ and attenuation parameters $\sigma_j^{\parallel}, \sigma_j^{\perp} \in \mathbb{R}_{>0}$.

Defined as:

$$
\Sigma_j := \mathcal{R}(\vec{d}_j)^\dagger \cdot \mathrm{diag}(\sigma_j^{\parallel}, \underbrace{\sigma_j^{\perp}, \dotsc, \sigma_j^{\perp}}_{N-1}, \sigma_j^{\parallel}, \underbrace{\sigma_j^{\perp}, \dotsc, \sigma_j^{\perp}}_{N-1}) \cdot \mathcal{R}(\vec{d}_j)
$$

where:

* $\mathcal{R}(\vec{d}_j) \in \mathrm{U}(2N)$ is the extended orthonormal frame aligned with direction $\vec{d}_j$,
* the diagonal encodes longitudinal scaling along $\vec{d}_j$ and isotropic transverse scaling in the orthogonal complement.

> **Clarification of the diagonal structure**:
>
> The diagonal matrix in the definition of $\Sigma_j$ contains exactly $2N$ entries, organized as two consecutive $N$-dimensional blocks. Each block begins with a longitudinal attenuation scalar $\sigma_j^{\parallel}$ followed by $N - 1$ transverse scalars $\sigma_j^{\perp}$. Explicitly, the diagonal is:
>
> $$
> \mathrm{diag}(\sigma_j^{\parallel}, \underbrace{\sigma_j^{\perp}, \dotsc, \sigma_j^{\perp}}_{N-1}, \sigma_j^{\parallel}, \underbrace{\sigma_j^{\perp}, \dotsc, \sigma_j^{\perp}}_{N-1})
> $$
>
> This ensures full dimensional consistency with $\mathcal{R}(\vec{d}_j) \in \mathrm{U}(2N)$ and preserves the anisotropic structure of the Gaussian envelope in both position and frequency domains.
> The dimension $2N$ arises from the fact that each field contribution $C_j$ is defined over the product space $\mathbb{T}_\mathbb{C}^N \times \mathbb{C}^N \cong \mathbb{C}^{2N}$, and thus its associated Gaussian envelope must be defined on $\mathbb{C}^{2N}$. This justifies the use of an extended orthonormal frame $\mathcal{R}(\vec{d}_j) \in \mathrm{U}(2N)$ and a $2N \times 2N$ covariance matrix.

This matrix defines a local Gaussian envelope aligned with the projection ray, and determines the spatial footprint of the contribution in the complex toroidal domain $\mathbb{T}_\mathbb{C}^N \times \mathbb{C}^N$.

It also defines a geometric coupling between the spatial domain and the higher semantic layer, acting as a weighting function for the influence of semantic content over the toroidal base.

---

### Unnormalized Gaussian Envelope

**$\rho_j(w) := \exp\left( -\pi \langle \Sigma_j^{-1} w, w \rangle \right)$** — *unnormalized anisotropic Gaussian* centered at field contribution $C_j$.

Here $w = \iota(\tilde{z} - \tilde{z}_j, \vec{d} - \vec{d}_j) \in \mathbb{C}^{2N}$. The envelope is aligned via $\Sigma_j$ (see: *Geometric Covariance Matrix*).

---

### Periodized Envelope

**$\psi_j^{\mathbb{T}}(z, \vec{d}) := \sum_{n \in \Lambda} \rho_j( \iota(\tilde{z} - \tilde{z}_j + n, \vec{d} - \vec{d}_j) )$** — *toroidally-periodized Gaussian envelope*.

This sum restores $\Lambda$-periodicity in $z$, ensuring compatibility with the toroidal structure of $\mathbb{T}_\mathbb{C}^N$.

---

### Spectral Content Vector

**$\hat{T}_j \in \mathbb{C}^S$** — *semantic spectral vector* assigned to a contribution $C_j$.

The dimensionality $S$ is arbitrary and model-defined, representing the number of harmonics stored in the local semantic spectrum.

$\hat{T}_j$ encodes localized semantic content directly in the spectral domain. It is not computed from other values, but defined as an intrinsic, stored parameter of the contribution. While not fixed in the sense of being immutable, it is persistent and modifiable through field operations.

> The vector $\hat{T}_j \in \mathbb{C}^S$ resides outside the toroidal spectral domain and belongs to a higher semantic layer — the second level of the CPSF field. It is not directly embedded in $\mathbb{T}_\mathbb{C}^N$, but its effect is made spatially meaningful through the localized weighting induced by $\Sigma_j$. Thus, the toroidal geometry acts as a spatial lens through which semantic content is projected.

---

### Field Contribution

**$C_j := (\ell_j, \hat{T}_j, \sigma_j^{\parallel}, \sigma_j^{\perp}, \alpha_j)$** — *elementary localized excitation in the field*, specified by:

* projection coordinate $\ell_j = (z_j, \vec{d}_j) \in \mathbb{T}_\mathbb{C}^N \times \mathbb{C}^N$,
* spectral content vector $\hat{T}_j \in \mathbb{C}^S$,
* attenuation scalars $\sigma_j^{\parallel}, \sigma_j^{\perp} \in \mathbb{R}_{>0}$,
* scalar weight $\alpha_j \in \mathbb{R}_{\ge 0}$.

Let $\mathcal{J} \subset \mathbb{N}$ denote a **finite** index set of contributions $\{ C_j \}_{j \in \mathcal{J}}$.

This tuple defines a directionally localized generator of field structure. The geometric part defines a region of influence on the toroidal base, while the semantic part modulates the content delivered into that region. Through their collective interference, such contributions define the emergent semantic field on the second level of CPSF.

---

### Global Field Response

**$T(z, \vec{d}) := \sum_{j \in \mathcal{J}} \alpha_j \cdot \psi_j^{\mathbb{T}}(z, \vec{d}) \cdot \hat{T}_j$** — *semantic field response* induced by a collection of contributions $\{C_j\}_{j \in \mathcal{J}}$.

Maps projection coordinates $(z, \vec{d})$ to semantic values in $\mathbb{C}^S$. See: *Spectral Content Vector*, *Field Contribution*.

---

### Reference Field and Semantic Error

* **$T^{\text{ref}}(z, \vec{d})$** — *reference projection response*, encoding ground truth or expected semantic content.

* **$\Delta T(z, \vec{d}) := T^{\text{ref}}(z, \vec{d}) - T(z, \vec{d})$** — *semantic error field*, representing discrepancy between reference and model response.

---

### Projection Space Measure

Let the field take values in $\mathbb{C}^S$. Define the product measure space over the projection domain $\mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}$:

* $L^2(\mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}; \mathbb{C}^S)$ — the Hilbert space of square-integrable $\mathbb{C}^S$-valued functions over the torus-direction domain.
* The inner product: $\langle f, g \rangle := \int_{\mathbb{T}_\mathbb{C}^N} \int_{\mathbb{S}^{2N-1}_\text{unit}} \sum_{s=1}^S \overline{f_s(z, \vec{d})} \cdot g_s(z, \vec{d})\, d\sigma(\vec{d})\, d\mu(z)$

Here:

* $d\mu(z)$: normalized Haar measure on the complex torus $\mathbb{T}_\mathbb{C}^N$;
* $d\sigma(\vec{d})$: rotationally invariant surface measure on the unit sphere $\mathbb{S}^{2N-1}_\text{unit} := { \vec{d} \in \mathbb{C}^N : \|\vec{d}\| = 1 }$ (see *"Core Terms — Rotationally Invariant Surface Measure"*).

This space defines the functional domain in which projection fields $T(z, \vec{d}) \in \mathbb{C}^S$ and semantic error fields $\Delta T(z, \vec{d})$ are analytically defined and compared.

---

### Rotationally Invariant Surface Measure

Let $\mathbb{S}^{2N-1}_\text{unit} := { \vec{d} \in \mathbb{C}^N : |\vec{d}|^2 = 1 }$ denote the unit sphere in $\mathbb{C}^N \cong \mathbb{R}^{2N}$.

The symbol $d\sigma(\vec{d})$ refers to the **unique $\mathrm{U}(N)$-invariant Borel probability measure** on $\mathbb{S}^{2N-1}_\text{unit}$, normalized such that:

$$
\int_{\mathbb{S}^{2N-1}_\text{unit}} d\sigma(\vec{d}) = 1
$$

This measure arises as the **induced surface measure** on the regular level set of the function $\rho(\vec{d}) := |\vec{d}|^2$ under the standard Lebesgue measure $d^{2N} \vec{d}$ on $\mathbb{C}^N$.

More precisely, $d\sigma$ is defined by the coarea formula:

$$
\int_{\mathbb{C}^N} f(\vec{d}) \, d^{2N}\vec{d} = \int_0^\infty \left( \int_{\|\vec{d}\|^2 = r^2} f(\vec{d}) \, d\sigma_r(\vec{d}) \right) \cdot r^{2N-1} dr
$$

where $d\sigma_r$ is the induced surface measure on the sphere of radius $r$. Then:

$$
d\sigma(\vec{d}) := \frac{1}{\omega_{2N-1}} \cdot d\sigma_1(\vec{d})
$$

with $\omega_{2N-1} := \mathrm{Vol}(\mathbb{S}^{2N-1}_\text{unit})$ the total surface area of the unit sphere.

This construction guarantees that $d\sigma$ is smooth, $\mathrm{U}(N)$-invariant, and normalized on $\mathbb{S}^{2N-1}_\text{unit}$.

---

### Semantic Error Projection

**$\Delta \hat{T}_j := \frac{1}{\alpha_j} \cdot \frac{ \int_{\mathbb{T}_\mathbb{C}^N} \int_{\mathbb{S}^{2N-1}_\text{unit}} \overline{\psi_j^{\mathbb{T}}(z, \vec{d})} \cdot \Delta T(z, \vec{d}) \, d\sigma(\vec{d}) \, d\mu(z) }{ \int_{\mathbb{T}_\mathbb{C}^N} \int_{\mathbb{S}^{2N-1}_\text{unit}} |\psi_j^{\mathbb{T}}(z, \vec{d})|^2 \, d\sigma(\vec{d}) \, d\mu(z) }$** — *orthogonal projection of semantic error onto contribution mode*.

This expression defines an $L^2$-orthogonal projection of the error field $\Delta T(z, \vec{d}) := T^{\text{ref}}(z, \vec{d}) - T(z, \vec{d})$ onto the localized envelope $\psi_j^{\mathbb{T}}$ associated with the contribution $C_j$.

All integrals are evaluated over the product domain $\mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}$ using the normalized Haar measure $d\mu(z)$ on the torus and the rotationally invariant surface measure $d\sigma(\vec{d})$ on the unit sphere.

This projection yields the update direction $\Delta \hat{T}_j \in \mathbb{C}^S$, which minimizes the squared $L^2$-error under the geometric localization induced by $\Sigma_j$.

---

### Dual Field Structure

**Dual Field Structure** — the foundational architecture of CPSF, consisting of two interdependent levels:

* **Geometric Level (Toroidal)**:
  Defined by the complex torus $\mathbb{T}_\mathbb{C}^N$, which provides a continuous coordinate system equipped with a global spectral basis $\phi_m(z)$. The localization of each field contribution $C_j$ is determined by a Gaussian envelope shaped by the covariance matrix $\Sigma_j$ and attenuation parameters $\sigma^{\parallel}, \sigma^{\perp}$.

* **Semantic Level (Off-Torus)**:
  Represented by spectral content vectors $\hat{T}_j \in \mathbb{C}^S$, which do not reside in the toroidal domain. Their influence is made spatially manifest through the geometry of their corresponding localization envelope in the torus, acting as a weight function.

> The semantic field emerges from the interference of these contributions $C_j$, each coupling its semantic content to a region of the toroidal domain. In this way, the geometry of the torus defines *where* influence occurs, while the spectral vector defines *what* is conveyed — and together, they construct the dual-layer field of CPSF.

---

## Orthonormal Frame Construction

---

TODO: Describe the Rodrigues method + antihermitian generator.

---

## Functional Role of $\Sigma_j$

This section defines the functional and geometric role of the matrix $\Sigma_j \in \mathbb{C}^{2N \times 2N}$, which governs the anisotropic localization of field contributions in the Continuous Projective Semantic Fields (CPSF).

---

### 1. Geometric Context and Projection Coordinates

Let $\ell_j := (z_j, \vec{d}_j) \in \mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}$ be a projection coordinate as defined in *"Core Terms — Projection Coordinates"*.

* $z_j \in \mathbb{T}_\mathbb{C}^N$ is a base point on the complex torus;
* $\vec{d}_j \in \mathbb{S}^{2N-1}_\text{unit} \subset \mathbb{C}^N$ is a unit-norm complex direction vector (i.e., $\|\vec{d}_j\| = 1$).

Let $(z, \vec{d}) \in \mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}$ be an arbitrary projection coordinate. We use lifted representatives $\tilde{z}, \tilde{z}_j \in \mathbb{C}^N$ such that $\tilde{z} \equiv z \mod \Lambda$, and define the relative offset:

$$
  w := \iota(\tilde{z} - \tilde{z}_j, \vec{d} - \vec{d}_j), \quad \iota(u, v) := \begin{bmatrix} u \\ v \end{bmatrix} \in \mathbb{C}^{2N}
$$

> **Geometric remark**: While both $\vec{d}$ and $\vec{d}_j$ lie on the unit sphere $\mathbb{S}^{2N-1}_\text{unit}$, the difference $\vec{d} - \vec{d}_j$ does not. It is interpreted in the ambient space $\mathbb{C}^N$ as an approximation to angular deviation within the tangent space at $\vec{d}_j$, and is valid only under the assumption that $\vec{d} \approx \vec{d}_j$.

---

### 2. Aligned Orthonormal Frame

As in *"Core Terms — Orthonormal Frame"*, define the unitary matrix $R(\vec{d}_j) \in \mathrm{U}(N)$ satisfying:

* $R(\vec{d}_j) e_1 = \vec{d}_j$
* The remaining columns span $\vec{d}_j^\perp$ and are orthonormal with respect to the Hermitian inner product:

$$
  \langle u, v \rangle := \sum_{k=1}^N \overline{u_k} v_k
$$

Define the extended block-diagonal frame:

$$
  \mathcal{R}(\vec{d}_j) := \mathrm{diag}(R(\vec{d}_j), R(\vec{d}_j)) \in \mathrm{U}(2N)
$$

This acts on $\mathbb{C}_{\text{pos}}^N \oplus \mathbb{C}_{\text{dir}}^N \cong \mathbb{C}^{2N}$, aligning both spatial and directional components with $\vec{d}_j$.

---

### 3. Attenuation and Covariance Matrix

Let $\sigma_j^{\parallel}, \sigma_j^{\perp} \in \mathbb{R}_{>0}$ be the longitudinal and transverse attenuation parameters respectively (see *"Core Terms — Attenuation Parameters"*).

Define the diagonal attenuation matrix:

$$
  D_j := \mathrm{diag}(\sigma_j^{\parallel}, \underbrace{\sigma_j^{\perp}, \dotsc, \sigma_j^{\perp}}_{N-1}, \sigma_j^{\parallel}, \underbrace{\sigma_j^{\perp}, \dotsc, \sigma_j^{\perp}}_{N-1}) \in \mathbb{R}^{2N \times 2N}
$$

Then the geometric covariance matrix is:

$$
  \Sigma_j := \mathcal{R}(\vec{d}_j)^{\dagger} \cdot D_j \cdot \mathcal{R}(\vec{d}_j) \in \mathbb{C}^{2N \times 2N}
$$

By construction, $\Sigma_j$ is Hermitian and strictly positive definite. It defines an anisotropic Gaussian metric whose principal axes are aligned with the projection direction $\vec{d}_j$, and whose longitudinal and transverse variances are given by $\sigma_j^{\parallel}$ and $\sigma_j^{\perp}$, respectively (see *"Core Terms — Geometric Covariance Matrix"*).

---

### 4. Gaussian Envelope and Periodization

Define the unnormalized anisotropic Gaussian envelope (see *"Core Terms — Unnormalized Gaussian Envelope"*):

$$
  \rho_j(w) := \exp\left( -\pi \langle \Sigma_j^{-1} w, w \rangle \right)
$$

where $w \in \mathbb{C}^{2N}$ is the relative offset defined above.

To restore toroidal periodicity in $z \in \mathbb{T}_\mathbb{C}^N$, define the periodized envelope (see *"Core Terms — Periodized Envelope"*):

$$
  \psi_j^{\mathbb{T}}(z, \vec{d}) := \sum_{n \in \Lambda} \rho_j\left( \iota(\tilde{z} - \tilde{z}_j + n, \vec{d} - \vec{d}_j) \right)
$$

This function is smooth, $\Lambda$-periodic in $z$, rapidly decaying in $\vec{d}$, and invariant under the choice of lifted representatives $\tilde{z}, \tilde{z}_j \in \mathbb{C}^N$. This invariance follows from the lattice summation over all $n \in \Lambda$, which eliminates dependence on the specific choice of representatives (see *"Core Terms — Periodized Envelope"*).

The envelope $\psi_j^{\mathbb{T}}$ thus localizes the influence of each field contribution $C_j$ to a region in projection space whose shape is geometrically induced by $\Sigma_j$.

---

### 5. Field Construction and Semantic Projection

Let $\mathcal{J} \subset \mathbb{N}$ index the finite collection of field contributions $C_j := (\ell_j, \hat{T}_j, \sigma_j^{\parallel}, \sigma_j^{\perp}, \alpha_j)$ as defined in *"Core Terms — Field Contribution"*.

Then the global semantic field (see *"Core Terms — Global Field Response"*) is:

$$
  T(z, \vec{d}) := \sum_{j \in \mathcal{J}} \alpha_j \cdot \psi_j^{\mathbb{T}}(z, \vec{d}) \cdot \hat{T}_j \in \mathbb{C}^S
$$

Let $T^{\text{ref}}(z, \vec{d}) \in \mathbb{C}^S$ denote a reference field. Define the semantic error field:

$$
  \Delta T(z, \vec{d}) := T^{\text{ref}}(z, \vec{d}) - T(z, \vec{d})
$$

Projecting this error onto the envelope $\psi_j^{\mathbb{T}}$ with respect to the canonical Hilbert space (see *"Core Terms — Projection Space Measure"*):

$$
  L^2(\mathbb{T}_\mathbb{C}^N \times \mathbb{S}^{2N-1}_\text{unit}; \mathbb{C}^S)
$$

yields the orthogonal projection (see *"Core Terms — Semantic Error Projection"*):

$$
  \Delta \hat{T}_j := \frac{1}{\alpha_j} \cdot \frac{ \int_{\mathbb{T}_\mathbb{C}^N} \int_{\mathbb{S}^{2N-1}_\text{unit}} \overline{\psi_j^{\mathbb{T}}(z, \vec{d})} \cdot \Delta T(z, \vec{d}) \, d\sigma(\vec{d}) \, d\mu(z) }{ \int_{\mathbb{T}_\mathbb{C}^N} \int_{\mathbb{S}^{2N-1}_\text{unit}} |\psi_j^{\mathbb{T}}(z, \vec{d})|^2 \, d\sigma(\vec{d}) \, d\mu(z) }
$$

This projection yields the optimal semantic update $\Delta \hat{T}_j \in \mathbb{C}^S$ that minimizes the squared error weighted by the localization profile $\psi_j^{\mathbb{T}}$, which in turn is induced by $\Sigma_j$.

---

### 6. Summary

* $\Sigma_j$ defines a directionally aligned, anisotropic envelope centered at $\ell_j$;
* Its construction follows from a block-diagonal frame $\mathcal{R}(\vec{d}_j)$ aligned with $\vec{d}_j$, and a diagonal attenuation matrix $D_j$;
* The Gaussian envelope $\psi_j^{\mathbb{T}}$ provides localized spatial and directional weighting for both field synthesis and semantic projection;
* The projection $\Delta \hat{T}_j$ minimizes the localized semantic error with respect to $\psi_j^{\mathbb{T}}$, making $\Sigma_j$ central to the semantic learning process;
* All constructions are fully and rigorously consistent with the canonical structure of CPSF.
